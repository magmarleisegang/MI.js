function DoAjax(n,t){setTimeout(function(){$("body").css("cursor","wait")},5);var o=n.data,u=n.url,i=n.successCallback,r=n.errorCallback,f=n.completeCallback,s=n.doAsync==undefined?!0:n.doAsync,e=n.timeout==undefined?2e4:n.timeout;return(t||e>2e4)&&alertUI("<img src='"+siteRoot+"/Images/busy.gif' alt='' />&nbsp;"+(t==undefined?"Please be patient - This might take a while!":t)),$.ajax({type:"POST",timeout:e,url:siteRoot+u,contentType:"application/json; charset=utf-8",data:o,dataType:"json",success:function(n){if(n.d==null||n.d.length==undefined)if(i)i(n);else return!0;else if(n.d[0]===!1&&n.d.length==3){var f=n.d[1],t=n.d[2];if(f.indexOf("F")==0&&(LogError(t,"LogScriptError.DoAjax - server side fatal error to: "+u,20),confirmUI("A fatal error has occured and the page needs to be reloaded.\nClick OK to reload.\nIf this problem persists please contact support.",!1,function(n){return n==!0?window.location.reload():alertUI(),!1})),r)r(null,t);else return alertUI(t,3e3),LogError(t,"LogScriptError.DoAjax - No error callback to: "+u,"32"),!1}else if(i)i(n);else return!0},error:function(n,t,i){var u,f;if(n.statusText=="abort")return!1;if(t.indexOf("timeout")!=-1||i.indexOf("timeout")!=-1)return alertUI("There has been an error processing your request.\nPlease try again later.",3e3),!1;if(u=JSON.parse(n.responseText),u.Message.indexOf("ER:")==0)f=u.Message.replace("ER:","");else if(u.Message.indexOf("F:")==0)LogError(u.Message,"Logbook page - server side fatal error",820),confirmUI("A fatal error has occured and the page needs to be refreshed.\nClick OK to refresh.\nIf this problem persists please contact support.",!1,function(n){return n==!0&&window.location.reload(),!1});else if(n.status==500)return alertUI("There has been an error processing your request.\nPlease try again later.",3e3),!1;if(r)r(n,f);else return alertUI("An error occured while processing your request. Please try again later or contact support",3e3),LogError(n.responseText,"Logbook page - DoAjax, No error callback","729"),!1},complete:function(){setTimeout(function(){$("body").css("cursor","auto")},5),f!=undefined&&f(),t&&alertUI()},async:s})}function alertUI(n,t){$.blockUI!=undefined?n?($.blockUI({message:n,css:{fontFamily:"Verdana",fontSize:"10pt",color:"#505050",padding:"20px"}}),t&&setTimeout($.unblockUI,t)):$.unblockUI():alert(n)}function confirmUI(n,t,i){if($.blockUI!=undefined){if(n){n=["<div class='confirm'>",n,"<div class='buttons'><img src='",siteRoot,"/Images/Button/",t?"yes.png":"ok.png","' alt='",t?"Yes":"Ok","' data-conf='1'/><img src='",siteRoot,"/Images/Button/",t?"no.png":"cancel.png","' alt='",t?"No":"Cancel","' data-conf='0'/><\/div><\/div>"].join(""),$.blockUI({message:n,css:{fontFamily:"Verdana",fontSize:"10pt",color:"#505050",padding:"20px",cursor:"pointer"}});$("div.confirm div.buttons img").one("click",function(){i($(this).data("conf")>0)&&$.unblockUI()})}}else confirm(n)}function addToCrumbtrail(n){crumbtrail.length>=10&&crumbtrail.shift(),crumbtrail.push(n)}function crumbtrailToString(){for(var t="",i=crumbtrail.length,n=0;n<i;n++)t+=n+": "+crumbtrail[n]+";";return t}function LogError(n,t,i){var r;$(document).css("cursor","auto"),r=crumbtrail==undefined||crumbtrail.length==0?t+", at LineNumber: "+i+". Message: "+n:t+", at LineNumber: "+i+". Message: "+n+". Crumbtrail: "+crumbtrailToString(),$.ajax({type:"POST",url:siteRoot+"/MappingWebService.asmx/LogJavascriptError",contentType:"application/json; charset=utf-8",data:'{"msg":"'+r.replace(/"/g,"'")+'"}',dataType:"json",success:function(){},error:function(){}})}var crumbtrail=[],siteRoot=window.location.protocol+"//"+window.location.hostname+"/"+(window.location.pathname.indexOf("/")==0&&window.location.pathname.split("/")[1].match(/triptracker|uk|us/i)!=undefined?window.location.pathname.split("/")[1].match(/triptracker|uk|us/i):"");siteRoot=siteRoot.replace("preqa.regcell.co.za","preqa.regcell.co.za:18080"),window.onerror=LogError